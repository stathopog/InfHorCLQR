# Infinite Horizon CLQR
C++ code for solving the infinite horizon constrained LQR problem with the dual proximal gradient method. Comparison with linear MPC.

## What it does
The regulation of a 2-state toy-system to the origin while respecting state and input constraints is solved using (i) the infinite horizon constrained LQR approach (**CLQR**) as presented in the corresponding papers (see References) and (ii) using conventional model predictive control (**MPC**). The problem is solved in closed loop and a perturbation to the initial state is applied at the beginning of each solve.

## How to use it
There are three folders, namely *data*, *main_CLQR* and *main_MPC*. 
The *data* folder contains the system's data (matrices & vectors in sparse and condensed form) and 750 feasible initial states stored in 'X_INIT_toy.mat'. It also contains four MATLAB files:

* **data.m:** Alter horizon length for MPC, perturbation amplitude etc. and run to generate new data.
* **small_random.m:** Generates the constrained toy-system.
* **upper_bound_beta.m:** Derives the upper bound for admissible stepsizes (used in Dual Proximal Gradient Method to solve the CLQR).
* **dense_form_generation.m:** Derives a condensed (input variables only) representation of the system generated by small_random.m.

In order to run the above codes, the [MPT3](http://people.ee.ethz.ch/~mpt/3/) toolbox needs to be installed.

The *main_CLQR* folder contains the compiled code for the CLQR solution. Execute `./clqr` from a terminal, located in `main_CLQR/build/src/CLQR`
The *main_MPC* folder contains the compiled code for the MPC solution. Execute `./mpc` from a terminal, located in `main_MPC/build/src/MPC`
After having performed any change to the codes (e.g., to the CLQR code), run the following commands:
```
cd main_CLQR/build
make
cd main_CLQR/build/src/CLQR
./clqr
```
## References
1. G. Stathopoulos, M. Korda and C. N. Jones, "Solving the infinite-horizon constrained LQR problem using splitting techniques", 19th IFAC World Congress 2014, https://infoscience.epfl.ch/record/197368?ln=en
2. G. Stathopoulos, M. Korda and C. N. Jones, "Solving the Infinite-Horizon Constrained LQR Problem Using Accelerated Dual Proximal Methods ", IEEE Transactions on Automatic Control, 62, 4, 1752-1767, 2016 https://infoscience.epfl.ch/record/228793?ln=en